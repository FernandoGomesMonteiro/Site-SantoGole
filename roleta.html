<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/menu.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/busca.css">
    <link rel="stylesheet" href="css/roleta.css">
</head>

<body>
    <header class="main-header" id="main-header">
        <a href="index.html" class="logo">Santo<span>Gole</span></a>
        <nav class="desktop-nav">
            <a href="index.html">InÃ­cio</a>
            <a href="/catalogo.html">CatÃ¡logo</a>
            <a href="/roleta.html" class="active">Surpresa</a>
            <a href="/sobre.html">Sobre</a>
        </nav>
        <div>
        </div>
    </header>

    <section class="hero">
        <div class="hero-content">
            <h1>Roleta e Drinks Surpresa</h1>
            <p>Gire a roleta e descubra um drink aleatÃ³rio ou explore nossa busca para encontrar sua receita perfeita!
            </p>
        </div>
    </section>

    <div style="display: flex;">
        <div class="drinkAleatorio">
            <h2>Encontre o Drink Perfeito</h2>
            <div class="search-container">
                <button style="display: none;" class="search-btn" id="search-btn">
                    <i class="fas fa-search"></i> Buscar
                </button>
                <button class="random-btn" id="random-btn">
                    <i class="fas fa-random"></i> Surpreenda-me
                </button>
            </div>

            <!-- Mensagens -->
            <div class="message" id="loading-message">
                <i class="fas fa-cocktail"></i>
                <p>Buscando drinks...</p>
            </div>

            <div class="message" id="error-message">
                <i class="fas fa-exclamation-circle"></i>
                <p>Nenhum drink encontrado. Tente outro termo.</p>
            </div>

            <!-- Resultados da Busca -->
            <div class="results-grid" id="results-grid">
                <!-- Os resultados serÃ£o inseridos aqui via JavaScript -->
            </div>

        </div>

        <section class="circle-roulette">
            <div class="roulette-wrapper">
                <h2>Monte sua Roleta de Drinks</h2>

                <div class="roulette-content">
                    <!-- Lista de drinks -->
                    <div class="drink-list-wrapper">
                        <div class="add-drink">
                            <input type="text" id="drink-input" placeholder="Digite o nome do drink">
                            <button id="add-drink-btn">Adicionar</button>
                        </div>
                        <ul id="drink-list"></ul>
                    </div>

                    <!-- Canvas da roleta -->
                    <div class="canvas-wrapper">
                        <canvas id="roulette" width="400" height="400"></canvas>
                        <button id="spin-btn">ðŸŽ‰ Girar a Roleta!</button>
                        <p id="result"></p>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <div id="overlay-result">
        <p id="overlay-text"></p>
    </div>

    <script>
        const canvas = document.getElementById('roulette');
        const ctx = canvas.getContext('2d');
        const drinkInput = document.getElementById('drink-input');
        const addDrinkBtn = document.getElementById('add-drink-btn');
        const drinkList = document.getElementById('drink-list');
        const spinBtn = document.getElementById('spin-btn');
        const result = document.getElementById('result');

        let drinks = [];
        let colors = ["#FFB74D", "#FF8A65", "#FF7043", "#FFA726", "#FF6F00", "#FFCC80", "#FFE0B2"];
        let startAngle = 0;
        let arc = 0;
        let spinTimeout = null;
        let spinAngleStart = 0;
        let spinTime = 0;
        let spinTimeTotal = 0;

        // Adicionar drink
        addDrinkBtn.addEventListener('click', () => {
            const drinkName = drinkInput.value.trim();
            if (drinkName && !drinks.includes(drinkName)) {
                drinks.push(drinkName);
                const li = document.createElement('li');
                li.textContent = drinkName;
                drinkList.appendChild(li);
                drinkInput.value = '';
                drawRouletteWheel();
            }
        });

        // Desenhar roleta
        function drawRouletteWheel() {
            if (drinks.length === 0) {
                ctx.clearRect(0, 0, 400, 400);
                return;
            }

            arc = 2 * Math.PI / drinks.length;
            const outsideRadius = 180;
            const textRadius = 130;
            const insideRadius = 50;

            ctx.clearRect(0, 0, 400, 400);

            for (let i = 0; i < drinks.length; i++) {
                const angle = startAngle + i * arc;
                ctx.fillStyle = colors[i % colors.length];
                ctx.beginPath();
                ctx.arc(200, 200, outsideRadius, angle, angle + arc, false);
                ctx.arc(200, 200, insideRadius, angle + arc, angle, true);
                ctx.fill();

                // Texto
                ctx.save();
                ctx.fillStyle = "#fff";
                ctx.translate(200 + Math.cos(angle + arc / 2) * textRadius,
                    200 + Math.sin(angle + arc / 2) * textRadius);
                ctx.rotate(angle + arc / 2 + Math.PI / 2);
                ctx.font = "16px Arial";
                ctx.textAlign = "center";
                ctx.fillText(drinks[i], 0, 0);
                ctx.restore();
            }

            // Indicador
            ctx.fillStyle = "#ff6f00";
            ctx.beginPath();
            ctx.moveTo(200 - 10, 200 - 180 - 5);
            ctx.lineTo(200 + 10, 200 - 180 - 5);
            ctx.lineTo(200, 200 - 180 + 15);
            ctx.fill();
        }

        function spin() {
            if (drinks.length === 0) {
                alert("Adicione pelo menos um drink!");
                return;
            }
            spinAngleStart = Math.random() * 10 + 10;
            spinTime = 0;
            spinTimeTotal = Math.random() * 3000 + 4000;
            rotateWheel();
        }

        function rotateWheel() {
            spinTime += 30;
            if (spinTime >= spinTimeTotal) {
                stopRotateWheel();
                return;
            }
            const spinAngle = spinAngleStart * (1 - spinTime / spinTimeTotal);
            startAngle += (spinAngle * Math.PI / 180);
            drawRouletteWheel();
            spinTimeout = setTimeout(rotateWheel, 30);
        }

        function stopRotateWheel() {
            clearTimeout(spinTimeout);
            const degrees = startAngle * 180 / Math.PI + 90;
            const arcd = arc * 180 / Math.PI;
            const index = Math.floor((360 - degrees % 360) / arcd);
            result.textContent = `ðŸ¹ O drink sorteado Ã©: ${drinks[index]}!`;
        }

        drawRouletteWheel();
        spinBtn.addEventListener('click', spin);

        function stopRotateWheel() {
            clearTimeout(spinTimeout);
            const degrees = startAngle * 180 / Math.PI + 90;
            const arcd = arc * 180 / Math.PI;
            const index = Math.floor((360 - degrees % 360) / arcd);
            const drink = drinks[index];

            // Mostrar overlay
            const overlay = document.getElementById('overlay-result');
            const overlayText = document.getElementById('overlay-text');
            overlayText.textContent = `ðŸ¹ O drink sorteado Ã©: ${drink}!`;
            overlay.classList.add('show');

            // Esconder depois de 3 segundos
            setTimeout(() => {
                overlay.classList.remove('show');
            }, 3000);
        }
    </script>

    <script src="js/menu.js"></script>
    <script src="js/footer.js"></script>
    <script src="js/busca.js"></script>
</body>

</html>